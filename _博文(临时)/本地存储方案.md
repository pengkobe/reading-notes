# 本地存储的几种方案

## Cookie
说到session就不得不说cookie了。  
cookie也是作为http协议的扩展，cookie会自动在浏览器和服务器之间传输。默认在用户关闭浏览器时清除数据，cookie设置案例为：
```
document.cookie = 'name=名称; max-age=过期时间; path=路径; domain=域名; secure';
```
注意：  
1. 指定为_secure_是,只有在https才传递到服务器端，http不会传递。
2. cookie在设置的有效期内有效，默认为浏览器关闭，max-age为0可以删除指定cookie
3. cookie有path概念，子路径可以访问父路径cookie，父路径不能访问子路径cookie
### 缺点
1. 每次随请求发送,增加流量
2. 大小/个数有限制，浏览器不能保存超过300个cookie，单个服务器不能超过20个，每个cookie不能超过4k。
3. 不安全，如果cookie被劫持，session就被泄漏了。
### 应用场景
判断用户是否登陆过网站


## LocalStorage
LocalStorage就是 Key-Value 的简单键值对存储结构。
### 缺点
* 不适合大型的结构化数据
* 低版本浏览器不支持。
* 一般只能存 5m。
* 有些浏览器如果使用"无痕浏览模式"会禁用localStorage的setItem方法
### 有性能问题？
参考: https://calendar.perfplanet.com/2012/is-localstorage-performance-a-problem/
这是一篇2012年的文章，作者认为 localstorage 在 PC 端带来的影响其实是不足为虑的，不过不建议首屏加载时直接使用。  
在 2017 年的今天我觉得移动端也不足为虑了，此外，兼容一类问题也早已不是问题。  
### 应用场景
缓存非关键性的 ajax 数据，如不经常更新的数据


## IndexedDB
可以存储结构对象，可构建 key 和 index 的索引方式查找，目前各浏览器的已经逐渐支持 IndexedDB 的存储方式，
适合存储大型的结构化数据，一定程度上弥补了 Localstorage 的不足。
### 各平台支持情况( 结果来自 caniuse.com )
* IE 10 & 11只支持部分功能
* Safari& iOS 8 & 9只支持部分功能，会出现严重 bug
* WebViews根本不支持.
### 应用场景
先问问自己这四个问题
* 你的用户通过浏览器访问您的应用程序,（浏览器）支持 IndexedDB API 吗 ?
* 你需要存储大量的数据在客户端?
* 你需要在一个大型的数据集合中快速定位单个数据点?
* 你的架构在客户端需要事务支持吗?


## FileSystem API
FileSystem API 相当于操作本地文件的存储方式，目前支持浏览器不多(只有 Chrome 和Opera 浏览器提供支持)，
其接口标准也在发展制定变化中，
应用场景举例：动态生成图片到本地文件，然后通过 filesystem:http:** 的URL方式直接赋值给 img 的 html 元素的 src 访问。


## Application Cache
对象是对浏览器的应用缓存的编程访问方式。简单来说，就是可以轻松的创建离线应用。
特性
* 离线浏览
* 提升页面载入速度
* 降低服务器压力其 status 属性可用于查看缓存的当前状态。
注意事项
* 各个页面统一管理自己的manifest清单,不同页面公共文件不能共用
* 大小不能超过5m
* 需要服务端进行配置
### 应用场景
WEB 离线应用


## 其它
### UserData
IE 专用技术,在没有 localstorage 的时代还是有用的
### SessionStorage
用这种方式存储的数据仅窗口级别有效，打开新的窗口或者跳转到新页面即失效。
### GlobalStorage
使用于 Firefox2+ 的火狐浏览器，类似于 IE 的 userData


## 数据共享
sessionStorage不能共享，localStorage在同源文档之间共享，cookie在同源且符合path规则的文档之间共享


## 参考
* [HTML5应用程序缓存Application Cache](http://www.cnblogs.com/yexiaochai/p/4271834.html)
* [前端的数据库：IndexedDB入门](http://web.jobbole.com/81793/)